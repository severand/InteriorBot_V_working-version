# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–ª–∞–Ω

---

## –ü—Ä–æ–±–ª–µ–º–∞

–°–µ–π—á–∞—Å –≤ —á–∞—Ç–µ –µ—Å—Ç—å KIE API c –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π PRO –º–æ–¥–∞, –Ω–æ:

- ‚ùå –ù–µ—Ç UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç, –∫–∞–∫–æ–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω
- ‚ùå –ù–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)
- ‚ùå –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î

**–ù—É–∂–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å –≤—Å—é —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç.

---

## –†–µ—à–µ–Ω–∏–µ

### –ü—Ä–æ—Ñ–∏–ª—å - —Ç–µ–∫—É—â–∏–π –≤–∏–¥

```
üë§ –í–ê–® –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢
‚îú‚îÄ‚îÄ üí≥ –ö—É–ø–∏—Ç—å
‚îú‚îÄ‚îÄ üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞
‚îî‚îÄ‚îÄ üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
```

### –ü—Ä–æ—Ñ–∏–ª—å - –ù–û–í–û–ï

```
üë§ –í–ê–® –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢
‚îú‚îÄ‚îÄ ‚ö° –†–ï–ñ–ò–ú: üîß PRO
‚îÇ   ‚îî‚îÄ –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (4K)
‚îÇ
‚îú‚îÄ‚îÄ üí≥ –ö–£–ü–ò–¢–¨:
‚îÇ   ‚îú‚îÄ üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç: 190 —Ä—É–±/10
‚îÇ   ‚îî‚îÄ üîß PRO: 490 —Ä—É–±/10
‚îÇ
‚îú‚îÄ‚îÄ ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò –†–ï–ñ–ò–ú–ê ‚Üê –ù–û–í–û–ï
‚îÇ
‚îú‚îÄ‚îÄ üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞
‚îî‚îÄ‚îÄ üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
```

---

## –ù–û–í–´–ï –≠–ö–†–ê–ù–´

### 1. –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ (PROFILE_SETTINGS)

–û–ø–µ–Ω—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ "‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò":

```
üìã –í–´–ë–û–† –†–ï–ñ–ò–ú–ê

–û–ü–ò–°–ê–ù–ò–ï:
üìã –°–¢–ê–ù–î–ê–†–¢ - –±—ã—Å—Ç—Ä—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
üîß PRO - –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

–í–ê–® –í–´–ë–û–†:
‚úÖ üìã –°–¢–ê–ù–î–ê–†–¢ (–∞–∫—Ç–∏–≤–µ–Ω)
‚óã üîß PRO (–Ω–∞–∂–º–∏—Ç–µ)

[‚¨ÖÔ∏è –ù–ê–ó–ê–î] [üè† –ú–ï–ù–Æ]
```

### 2. –≠–∫—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ PRO (PRO_SETTINGS)

–í–∏–¥–µ–Ω **—Ç–æ–ª—å–∫–æ** –∫–æ–≥–¥–∞ –≤—ã–±—Ä–∞–Ω PRO —Ä–µ–∂–∏–º:

```
üîß –ü–ê–†–ê–ú–ï–¢–†–´ PRO

üñºÔ∏è –°–û–û–¢–ù–û–®–ï–ù–ò–ï –°–¢–û–†–û–ù:
16:9 ‚úÖ  4:3  1:1  9:16

Click –¥–ª—è –≤—ã–±–æ—Ä–∞

üìê –†–ê–ó–†–ï–®–ï–ù–ò–ï:
1K ‚úÖ  2K  4K

Click –¥–ª—è –≤—ã–±–æ—Ä–∞

[‚¨ÖÔ∏è –ù–ê–ó–ê–î] [üè† –ú–ï–ù–Æ]
```

---

## –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –†–ï–ñ–ò–ú–ê

### –ù–∞ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ (header)

```
–¢–µ–∫—É—â–∏–π:
‚ö° –ë–∞–ª–∞–Ω—Å: 15

–ù–û–í–û–ï:
‚ö° –ë–∞–ª–∞–Ω—Å: 15 | –†–µ–∂–∏–º: üîß PRO
```

### –ù–∞ —ç–∫—Ä–∞–Ω–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```
üçú –£–ø–ª–æ–∞–¥—å—Ç–µ —Ñ–æ—Ç–æ

–ê–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º: üîß PRO
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: 16:9, 1K
```

### –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```
[–û–ë–†–ê–ó–û–¶]

‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ —Ä–µ–∂–∏–º–µ: üîß PRO
‚ö° -1 –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
–ë–∞–ª–∞–Ω—Å: 14
```

---

## –ù–û–í–´–ï –ü–û–õ–Ø –í –ë–î

```sql
-- –î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É users

ALTER TABLE users ADD COLUMN pro_mode BOOLEAN DEFAULT 0;
-- –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º (0=–°—Ç–∞–Ω–¥–∞—Ä—Ç, 1=PRO)

ALTER TABLE users ADD COLUMN pro_aspect_ratio TEXT DEFAULT '16:9';
-- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω

ALTER TABLE users ADD COLUMN pro_resolution TEXT DEFAULT '1K';
-- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ (1K, 2K, 4K)

ALTER TABLE users ADD COLUMN pro_mode_changed_at TEXT;
-- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

---

## –ö–ê–ö–û–ï –§–£–ù–ö–¶–ò–û–ù–ê–õ –î–û–±–ê–í–ò–¢–¨

### 1. –ë–¥ (db.py)

```python
# –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

def get_user_pro_settings(user_id: int) -> dict:
    # –û—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∂–∏–º–∞
    # –í–µ—Ä–Ω—É—Ç: {pro_mode, pro_aspect_ratio, pro_resolution}

def set_user_pro_mode(user_id: int, mode: bool) -> bool:
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∂–∏–º
    # mode: True = PRO, False = –°—Ç–∞–Ω–¥–∞—Ä—Ç

def set_pro_aspect_ratio(user_id: int, ratio: str) -> bool:
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ
    # ratio: "16:9", "4:3", "1:1", "9:16"

def set_pro_resolution(user_id: int, res: str) -> bool:
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
    # res: "1K", "2K", "4K"
```

### 2. –•–µ–ª–ø–µ—Ä—ã (helpers.py)

```python
# –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ add_balance_to_text():

def add_balance_and_mode_to_text(text: str, balance: int, pro_mode: bool) -> str:
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    # "‚ö° –ë–∞–ª–∞–Ω—Å: 15 | –†–µ–∂–∏–º: üîß PRO\n\n" + text
    # –∏–ª–∏
    # "‚ö° –ë–∞–ª–∞–Ω—Å: 15\n\n" + text –Ω–ª—è –°—Ç–∞–Ω–¥–∞—Ä—Ç
```

### 3. –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (texts.py)

```python
PROFILE_SETTINGS_TEXT = """
üìã –í–´–ë–û–† –†–ï–ñ–ò–ú–ê
...
"""

PRO_SETTINGS_TEXT = """
üîß –ü–ê–†–ê–ú–ï–¢–†–´ PRO
...
"""

MODE_CHANGED_TEXT = """
‚úÖ –†–µ–∂–∏–º –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ {mode_name}
...
"""
```

### 4. –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã (keyboards/inline.py)

```python
# –ù–æ–≤—ã–µ:
def get_mode_selection_keyboard() -> InlineKeyboardMarkup:
    # –ö–Ω–æ–ø–∫–∏ —Å –≤—ã–±–æ—Ä–æ–º —Ä–µ–∂–∏–º–∞

def get_pro_params_keyboard() -> InlineKeyboardMarkup:
    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

# –û–±–Ω–æ–≤–∏—Ç—å:
def get_profile_keyboard() -> InlineKeyboardMarkup:
    # –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò"
```

### 5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (handlers/user_start.py)

```python
# –ù–æ–≤—ã–µ:
async def profile_settings_handler(call: CallbackQuery, state: FSMContext):
    # –û—Ç–∫—Ä—é—Ç—å PROFILE_SETTINGS —ç–∫—Ä–∞–Ω

async def switch_mode_handler(call: CallbackQuery, state: FSMContext):
    # –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å

async def pro_settings_handler(call: CallbackQuery, state: FSMContext):
    # –û—Ç–∫—Ä—é—Ç—å PRO_SETTINGS —ç–∫—Ä–∞–Ω (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ PRO –∞–∫—Ç–∏–≤)

async def set_pro_params_handler(call: CallbackQuery, state: FSMContext):
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

---

## –ö–û–ù–ö–†–ï–¢–ù–´–ï –î–û–ü–û–õ–ù–ï–ù–ò–Ø

### –í –ø—Ä–æ—Ñ–∏–ª—å (profile_handler)

```python
# –¢–µ–∫—É—â–µ–µ:
profile_text = "‚ö° –ë–∞–ª–∞–Ω—Å: {balance}\n\n..."

# –ù–û–í–û–ï:
user_mode = "PRO" if user.pro_mode else "–°—Ç–∞–Ω–¥–∞—Ä—Ç"
mode_icon = "üîß" if user.pro_mode else "üìã"

profile_text = f"""
‚ö° –ë–ê–õ–ê–ù–°: {balance}
{mode_icon} –†–ï–ñ–ò–ú: {user_mode}

üí≥ –°–û–°–¢–û–ò–ú–û–°–¢–¨:
üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç: 190 —Ä—É–±/10
üîß PRO: 490 —Ä—É–±/10
...
"""
```

### –ù–∞ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (header)

```python
# –¢–µ–∫—É—â–µ–µ:
await call.message.edit_text(add_balance_to_text(text, user.balance))

# –ù–û–í–û–ï:
await call.message.edit_text(
    add_balance_and_mode_to_text(text, user.balance, user.pro_mode)
)
```

---

## –ß—Ç–æ –ù–ï –ú–ï–ù—è–¢–¨

‚úÖ **bot/services/kie_api.py** - —É–∂–µ –≥–æ—Ç–æ–≤, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ **bot/states/fsm.py** - –Ω–µ –Ω—É–∂–Ω—ã –Ω–æ–≤—ã–µ states
‚úÖ **config_kie.py** - –≤—Å—ë –µ—Å—Ç—å

---

## –ö–ª—é—á–µ–≤—ã–µ –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–û–¥–∏–Ω –±–∞–ª–∞–Ω—Å –Ω–∞ –≤—Å–µ—Ö** - –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∂–∏–º–∞
2. **–¶–µ–Ω–∞ —Ä–∞–∑–Ω–∞—è** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç 190, PRO 490, –Ω–æ –±–∞–ª–∞–Ω—Å –æ–¥–∏–Ω
3. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ** - –≤—Å–µ —Ä–µ–∂–∏–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (aspect_ratio, resolution)
4. **–†–µ–∂–∏–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
5. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –í–ù–ï –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–Ω—É** - —Ä–∞—Å—Å—Ç–ª–±—é –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞—á–µ—Å—Ç–≤—É, –Ω–µ –∫ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
